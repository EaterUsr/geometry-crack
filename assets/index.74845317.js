var A=Object.defineProperty;var E=(i,t,e)=>t in i?A(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var u=(i,t,e)=>(E(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();function N(i,t){return i>t?i-t:t-i}let T=[...Array(5)];T=T.map((i,t)=>t*90);function q(i){let t=[...new Array(5)];t=t.map((s,o)=>N(T[o],i));let e=361,n=0;return t.map((s,o)=>{e>s&&(e=s,n=o)}),T[n]}class O{constructor(t,e,n,s,o,r){u(this,"velocity",0);u(this,"jumpHeight",0);u(this,"deg",0);this.ctx=t,this.originX=e,this.originY=n,this.size=s,this.floorHeight=o,this.speed=r}cubeTouchTheFloor(){return this.originY-this.jumpHeight+this.size>=this.floorHeight}update(t,e){this.ctx.fillStyle="black",this.velocity-=this.velocity===0?0:1,this.jumpHeight+=this.velocity*t*.05,this.cubeTouchTheFloor()?(this.jumpHeight=0,this.velocity=0,this.deg%=360,this.deg=q(this.deg),this.originY=this.floorHeight-this.size):(this.deg+=8,this.jumpHeight-=7),e||(this.originX-=this.speed*t);const n=[this.originX,this.originY-this.jumpHeight],s=[n[0]+this.size/2,n[1]+this.size/2];this.ctx.save(),this.ctx.translate(...s),this.ctx.rotate(this.deg*Math.PI/180),this.ctx.translate(-s[0],-s[1]),this.ctx.fillRect(...n,this.size,this.size),this.ctx.restore()}jump(){this.cubeTouchTheFloor()&&(this.velocity=22)}}const d=new Path2D;d.moveTo(20,50);d.arcTo(-30,40,20,20,15);d.arcTo(20,-15,60,20,17);d.arcTo(70,-10,80,25,17);d.arcTo(100,-10,100,25,15);d.arcTo(150,35,110,50,15);d.arcTo(110,100,70,60,15);d.arcTo(65,80,40,50,17);d.arcTo(30,80,20,50,17);d.closePath();class S{constructor(t,e,n,s,o,r){u(this,"position",0);u(this,"path",d);u(this,"color","white");this.ctx=t,this.size=e,this.speed=n,this.height=s,this.canvasWidth=o,this.isReturn=r}update(t){const e=this.canvasWidth-this.position+(this.isReturn?this.size:0),n=this.isReturn?-this.size:this.size;this.ctx.save(),this.ctx.translate(e,this.height),this.ctx.scale(1/140*n,1/140*this.size),this.ctx.fillStyle=this.color,this.ctx.fill(this.path),this.ctx.restore(),this.position+=this.speed*t}}const X=new Path2D,M=40;X.arc(M,M,M,0,Math.PI*2);class B extends S{constructor(e,n,s,o,r){super(e,n,s,o,r,!1);u(this,"path",X);u(this,"color","#8B3E00")}}class y{constructor(t,e,n,s,o,r){this.ctx=t,this.positionX=e,this.positionY=n,this.speed=s,this.size=o,this.canvasWidth=r}drawPatern(){}updatePosition(t){this.positionX-=this.speed*t}update(t){this.drawPatern(),this.updatePosition(t)}}class W extends y{drawPatern(){this.ctx.save(),this.ctx.translate(this.positionX,this.positionY),this.ctx.beginPath(),this.ctx.moveTo(0,this.size),this.ctx.lineTo(this.size/2,0),this.ctx.lineTo(this.size,this.size),this.ctx.closePath(),this.ctx.fillStyle="red",this.ctx.fill(),this.ctx.restore()}}class _ extends y{drawPatern(){this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(this.positionX,this.positionY),this.ctx.moveTo(0,0),this.ctx.lineTo(this.size,0),this.ctx.lineTo(this.size,this.size/2),this.ctx.lineTo(0,this.size/2),this.ctx.closePath(),this.ctx.fillStyle="black",this.ctx.fill(),this.ctx.restore()}}function K(i){return{value:i,next:null}}class H{constructor(){u(this,"head");u(this,"tail");u(this,"length",0);this.head=null,this.tail=null}append(t){let e=K(t);return this.length++,this.tail?(this.tail.next=e,this.tail=e,e):(this.head=this.tail=e,e)}forEach(t){let e=this.head,n=0;for(;e;)t(e.value,n),e=e.next,n++}removeFirst(){if(this.length--,!this.head)return null;let t=this.head;return this.head=t.next,t.next=null,t===this.tail&&(this.tail=null),t}}function F(i,t,e,n){const s=2+1/i,o=e*i/t,r=new H;let a=0;for(;a<s;)a++,r.append(n());return r.forEach((h,f)=>{h.update(o*(Math.floor(s-f)-1))}),setInterval(()=>{r.append(n()),r.removeFirst()},o),h=>{r.forEach(f=>{f.update(h)})}}function U(i,t,e,n){const s=[...new Array(4)];let o=[0,0],r=0,a=0;for(let h in s)r=h==="0"?0:Math.floor(Math.sin(e/360*Math.PI*2+(Number(h)-1)*Math.PI/2)*n+o[0]),a=h==="0"?0:Math.floor(Math.cos(e/360*Math.PI*2+(Number(h)-1)*Math.PI/2)*n+o[1]),o=[r,a],s[h]=[r+i,a+t];return s}function V(i,t,e){return[[i,t+e],[i+e/2,t],[i+e,t+e]]}function G(i,t,e){return[[i,t],[i+e,t],[i+e,t+e/2],[i,t+e/2]]}function J(i,t,e,n,s,o,r,a){const h=((r-s)*(t-o)-(a-o)*(i-s))/((a-o)*(e-i)-(r-s)*(n-t)),f=((e-i)*(t-o)-(n-t)*(i-s))/((a-o)*(e-i)-(r-s)*(n-t));return h>=0&&h<=1&&f>=0&&f<=1}function P(i,t){let e,n,s,o=!1;for(let r=0;r<i.length;r++)if(e=Number(r)+1,e===i.length&&(e=0),n=i[r],s=i[e],o=Q(n[0],n[1],s[0],s[1],t),o)return o;return!1}function Q(i,t,e,n,s){let o,r,a,h=!1;for(let f=0;f<s.length;f++)if(o=Number(f)+1,o===s.length&&(o=0),r=s[f],a=s[o],h=J(r[0],r[1],a[0],a[1],i,t,e,n),h)return h;return!1}const Y=document.querySelector("#game"),p=Y.getContext("2d"),{width:c,height:g}=Y;function D(i,t){return Math.floor(Math.random()*(t-i+1)+i)}const w=c/365/4,m=Math.floor(g/10),Z=Math.floor(m/w),$=Math.floor(c/2-m/2),L=Math.floor(g/2-m/2),x=Math.floor(L+m),k=Math.floor(g/20),l=new O(p,$,L,m,x,w),tt=.3,b=w/4;function et(){return D(c/6,c/5)}function it(){return Math.random()*Math.floor(c/18)}function st(){return new S(p,et(),b,it(),c,Boolean(Math.floor(Math.random()*2)))}const ot=F(tt,b,c,st),nt=.25,j=w;function rt(){return D(c/9,c/7)}function ht(){return Math.random()*Math.floor(c/18)+Math.floor(g/1.5)}function lt(){return new B(p,rt(),j,ht(),c)}const ct=F(nt,j,c,lt),at=new H;let C=Date.now(),v=!0,z=!1;function I(){window.requestAnimationFrame(I),z&&(l.floorHeight=x),p.fillStyle="#00C2FF",p.fillRect(0,0,c,g),p.fillStyle="#9B5400",p.fillRect(0,x,c,g/2-l.size/2);const i=Date.now()-C,t=U(l.originX+l.size*(l.deg%90/90),l.originY-l.jumpHeight,-(l.deg%90),l.size);at.forEach(e=>{if(e.update(i),e.positionX>=l.originX&&e.positionX<l.originX+l.size/2){if(e instanceof W){const n=V(e.positionX,e.positionY,e.size);P(t,n)&&console.log("game over")}else if(e instanceof _){const n=G(e.positionX,e.positionY,e.size),s=t.reduce((o,r)=>[o[0]+r[0],o[1]+r[1]]).map(o=>o/t.length);P(t,n)&&(s[1]<=e.positionY&&s[0]>=e.positionX/2?(setTimeout(()=>{z=!0},Z),l.floorHeight=e.positionY,v=!0,z=!1):v=!1)}}e.positionX<0}),ot(i),ct(i),l.update(i,v),p.fillStyle="#1CA600",p.fillRect(0,x,c,k),C=Date.now()}I();function R(){l.jump()}document.addEventListener("keydown",i=>{(i.key===" "||i.key==="ArrowUp")&&R()});document.addEventListener("click",R);
